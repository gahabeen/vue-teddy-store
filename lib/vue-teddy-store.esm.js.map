{"version":3,"file":"vue-teddy-store.esm.js","sources":["../src/install/vue-composition-api.js","../src/utils.js","../src/plugins/cache.js","../src/plugins/history.js","../src/plugins/sync.js","../src/index.js"],"sourcesContent":["import Vue from \"vue\";\r\nimport VueCompositionApi from \"@vue/composition-api\";\r\nVue.use(VueCompositionApi);\r\n","const VARIABLE_PATH = /({.+?})/gim\r\n\r\nfunction resolvePath(instance) {\r\n  return (path) => {\r\n    const variablePath = get(instance, path.slice(1, -1).trim())\r\n    if (['string', 'number'].includes(typeof variablePath)) {\r\n      return variablePath\r\n    } else {\r\n      /* istanbul ignore next */\r\n      throw new Error`Couldn't not find any proper value for ${variablePath}`()\r\n    }\r\n  }\r\n}\r\n\r\nexport function isComputed(obj) {\r\n  if (!obj || typeof obj !== 'object' || !('value' in obj)) return false\r\n  const desc = Object.getOwnPropertyDescriptor(obj, 'value')\r\n  return typeof desc.get === 'function' && typeof desc.set === 'function'\r\n}\r\n\r\nexport function omit(obj, keys = []) {\r\n  return Object.keys(obj).reduce((acc, key) => {\r\n    if (!key.includes(keys)) {\r\n      acc[key] = obj[key]\r\n    }\r\n    return acc\r\n  }, {})\r\n}\r\n\r\nexport function debounce(fn, wait = 100) {\r\n  let timeout\r\n  return function(...args) {\r\n    clearTimeout(timeout)\r\n    timeout = setTimeout(() => {\r\n      fn.apply(this, args)\r\n    }, wait)\r\n  }\r\n}\r\n\r\nexport function hasProp(obj, key) {\r\n  if (!obj || typeof obj !== 'object') return\r\n  if (isComputed(obj) && key in obj.value) {\r\n    return true\r\n  } else if (key in obj) {\r\n    return true\r\n  } else {\r\n    return false\r\n  }\r\n}\r\n\r\nexport function getProp(obj, key) {\r\n  if (isComputed(obj) && key in obj.value) {\r\n    return obj.value[key]\r\n  } else if (key in obj) {\r\n    return obj[key]\r\n  }\r\n}\r\n\r\nexport function get(obj, path, defaultValue, instance) {\r\n  const steps = String(path)\r\n    .replace(/\\[/g, '.')\r\n    .replace(/]/g, '')\r\n    .replace(VARIABLE_PATH, resolvePath(instance))\r\n    .split('.')\r\n\r\n  function _get(item, steps, fallback) {\r\n    if (steps.length > 0) {\r\n      const step = steps.shift()\r\n      const stepValue = getProp(item, step) || fallback\r\n      return _get(stepValue, steps, fallback)\r\n    } else {\r\n      return item\r\n    }\r\n  }\r\n\r\n  return _get(obj, steps, defaultValue)\r\n}\r\n\r\nexport function setProp(obj, key, value) {\r\n  if (isComputed(obj) && key in obj.value) {\r\n    obj.value[key] = value\r\n    return obj.value[key]\r\n  } else {\r\n    obj[key] = value\r\n    return obj[key]\r\n  }\r\n}\r\n\r\nexport function set(obj, path, value, instance) {\r\n  const steps = String(path)\r\n    .replace(/\\[/g, '.')\r\n    .replace(/]/g, '')\r\n    .replace(VARIABLE_PATH, resolvePath(instance))\r\n    .split('.')\r\n\r\n  const cleanStep = (key) => key.replace(/^\\^/, '')\r\n\r\n  const _set = (item, steps, val) => {\r\n    const step = cleanStep(steps.shift())\r\n    if (steps.length > 0) {\r\n      if (!hasProp(item, step)) {\r\n        const nextStep = steps[0]\r\n        if (Number.isInteger(+nextStep)) {\r\n          return _set(setProp(item, step, []), steps, val)\r\n        } else {\r\n          // To force an integer as an object property, prefix it with ^\r\n          // If somehow you want to have a ^ in a key name, double it ^^\r\n          return _set(setProp(item, step, {}), steps, val)\r\n        }\r\n      } else {\r\n        return _set(getProp(item, step), steps, val)\r\n      }\r\n    } else {\r\n      setProp(item, step, val)\r\n    }\r\n  }\r\n\r\n  if (steps.length > 0) {\r\n    _set(obj, steps, value)\r\n  } else {\r\n    // hmm\r\n    if (obj.value) {\r\n      obj.value = value\r\n    } else {\r\n      obj = value\r\n    }\r\n  }\r\n\r\n  return obj\r\n}\r\n","import { watch } from '@vue/composition-api'\r\n// import { debounce } from '../utils'\r\n\r\nexport const prefix = (name) => `teddy:store:${name}`\r\nexport default {\r\n  handle({ name, store }) {\r\n    /* istanbul ignore next */\r\n    const localStorage = window.localStorage || global.localStorage || {}\r\n    /* istanbul ignore next */\r\n    if (localStorage) {\r\n      // Fetched saved state when exists\r\n      // const cached = localStorage.getItem(prefix(name))\r\n      // if (cached) store._state = { ...store._state, ...JSON.parse(cached) }\r\n      // Watch for mutations, save them\r\n      watch(\r\n        () => store._state,\r\n        (newState, oldState) => {\r\n          console.log('caching', newState)\r\n          if (newState !== oldState) {\r\n            localStorage.setItem(prefix(name), JSON.stringify(newState))\r\n          }\r\n        },\r\n        { immediate: true, deep: true }\r\n      )\r\n    }\r\n  },\r\n}\r\n","import { reactive, watch } from '@vue/composition-api'\r\n\r\nexport default {\r\n  handle({ store }) {\r\n    store._history = reactive([])\r\n    watch(\r\n      store._state,\r\n      (newState) => {\r\n        store._history.push(newState)\r\n      },\r\n      { immediate: true, deep: true }\r\n    )\r\n  },\r\n}\r\n","import { reactive } from '@vue/composition-api'\r\nimport { prefix } from './cache'\r\n\r\nexport default {\r\n  handle({ name, store }) {\r\n    /* istanbul ignore next */\r\n    if (window) {\r\n      window.addEventListener('storage', (e) => {\r\n        if (e.key === prefix(name)) {\r\n          store._state = reactive({ ...store._state, ...JSON.parse(e.newValue) })\r\n        }\r\n      })\r\n    }\r\n  },\r\n}\r\n","import './install/vue-composition-api'\r\nimport { computed, watch, ref, isRef, isReactive, toRef } from '@vue/composition-api'\r\n\r\nimport * as utils from './utils'\r\n\r\nimport CachePlugin from './plugins/cache'\r\nimport HistoryPlugin from './plugins/history'\r\nimport SyncPlugin from './plugins/sync'\r\n\r\nfunction getInstance(...solutions) {\r\n  const instanceSolution = solutions.find((s) => s && s instanceof TeddyStore)\r\n  const contextSolution = solutions.find((s) => s && '$teddy' in s && s.$teddy instanceof TeddyStore)\r\n  const solution = instanceSolution || (contextSolution ? contextSolution.$teddy : undefined)\r\n  if (!solution) {\r\n    /* istanbul ignore next */\r\n    throw new Error(`Couldn't find any proper instance!`)\r\n  }\r\n  return solution\r\n}\r\n\r\nexport default class TeddyStore {\r\n  constructor() {\r\n    this._stores = {}\r\n    this._plugins = {\r\n      cache: CachePlugin,\r\n      history: HistoryPlugin,\r\n      sync: SyncPlugin,\r\n    }\r\n  }\r\n\r\n  add(name, store) {\r\n    const others = utils.omit(store, ['state', 'methods', 'watchers'])\r\n\r\n    this._stores[name] = {\r\n      state: TeddyStore.createState(store.state),\r\n      ...(store.methods || {}),\r\n      ...others,\r\n    }\r\n\r\n    const watchers = []\r\n    if (Array.isArray(store.watchers)) {\r\n      watchers.push(...store.watchers)\r\n    } else if (store.watcher) {\r\n      watchers.push(store.watcher)\r\n    }\r\n\r\n    for (let watcher of watchers) {\r\n      if (typeof watcher === 'function') {\r\n        watch(() => this._stores[name].state.value, watcher, { deep: true })\r\n      } else if (watcher && typeof watcher === 'object' && 'handler' in watcher) {\r\n        const { handler, path, paths = [], ...options } = watcher\r\n        if (path) {\r\n          watch(() => utils.get(this._stores[name].state.value, path), handler, { deep: true, ...options })\r\n        } else if (paths.length > 0) {\r\n          watch(\r\n            paths.map((p) => () => utils.get(this._stores[name].state.value, p)),\r\n            handler,\r\n            { deep: true, ...options }\r\n          )\r\n        } else {\r\n          watch(() => this._stores[name].state.value, handler, { deep: true, ...options })\r\n        }\r\n      }\r\n    }\r\n\r\n    return this\r\n  }\r\n\r\n  use(plugin = {}) {\r\n    if (typeof plugin.install === 'function') {\r\n      plugin.install(this)\r\n    }\r\n    if (typeof plugin.handle === 'function') {\r\n      Object.keys(this._stores).map((name) => plugin.handle.call(this, { name, store: this._stores[name] }))\r\n    }\r\n    return this\r\n  }\r\n\r\n  activate(pluginNames = []) {\r\n    if (!Array.isArray(pluginNames)) pluginNames = [pluginNames]\r\n    for (let pluginName of pluginNames) {\r\n      if (pluginName in this._plugins) {\r\n        this.use(this._plugins[pluginName])\r\n      }\r\n    }\r\n    return this\r\n  }\r\n\r\n  install(VueInstance) {\r\n    VueInstance.prototype.$teddy = this\r\n  }\r\n\r\n  get stores() {\r\n    return this._stores\r\n  }\r\n\r\n  static createState(newState) {\r\n    return isReactive(newState) ? toRef(newState) : isRef(newState) ? newState : ref(newState)\r\n  }\r\n\r\n  get(name, path) {\r\n    return TeddyStore.get(name, path, this)\r\n  }\r\n\r\n  static get(name, path, context) {\r\n    context = context || this\r\n    return function get() {\r\n      const _instance = getInstance(this, context)\r\n      return utils.get(_instance, `stores.${name}.value.state.value.${path}`, undefined, context)\r\n    }\r\n  }\r\n\r\n  set(name, path) {\r\n    return TeddyStore.set(name, path, this)\r\n  }\r\n\r\n  static set(name, path, context) {\r\n    context = context || this\r\n    return function set(value) {\r\n      const _instance = getInstance(this, context)\r\n      utils.set(_instance, `stores.${name}.state.${path}`, value, context)\r\n    }\r\n  }\r\n\r\n  compute(name, path) {\r\n    return TeddyStore.compute(name, path, this)\r\n  }\r\n\r\n  static compute(name, path, context) {\r\n    context = context || this\r\n    const get = TeddyStore.get(name, path, context)\r\n    const set = TeddyStore.set(name, path, context)\r\n    return computed({ get, set })\r\n  }\r\n}\r\n"],"names":["const","utils.omit","let","this","utils.get","get","set","utils.set"],"mappings":"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"}