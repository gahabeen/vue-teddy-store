{"version":3,"file":"vue-teddy-store.esm.js","sources":["../src/utils.js","../src/plugins/cache.js","../src/plugins/history.js","../src/plugins/sync.js","../src/index.js"],"sourcesContent":["const VARIABLE_PATH = /({.+?})/gim\r\n\r\nfunction resolvePath(instance) {\r\n  return (path) => {\r\n    const variablePath = get(instance, path.slice(1, -1).trim())\r\n    if (['string', 'number'].includes(typeof variablePath)) {\r\n      return variablePath\r\n    } else {\r\n      /* istanbul ignore next */\r\n      throw new Error`Couldn't not find any proper value for ${variablePath}`()\r\n    }\r\n  }\r\n}\r\n\r\nexport function debounce(fn, wait = 100) {\r\n  let timeout\r\n  return function(...args) {\r\n    clearTimeout(timeout)\r\n    timeout = setTimeout(() => {\r\n      fn.apply(this, args)\r\n    }, wait)\r\n  }\r\n}\r\n\r\nexport function get(obj, path, defaultValue, instance) {\r\n  return String(path)\r\n    .replace(/\\[/g, '.')\r\n    .replace(/]/g, '')\r\n    .replace(VARIABLE_PATH, resolvePath(instance))\r\n    .split('.')\r\n    .reduce((acc, v) => {\r\n      try {\r\n        acc = acc[v] === undefined ? defaultValue : acc[v]\r\n      } catch (e) {\r\n        /* istanbul ignore next */\r\n        return defaultValue\r\n      }\r\n      return acc\r\n    }, obj)\r\n}\r\n\r\nexport function set(obj, path, value, instance) {\r\n  const steps = String(path)\r\n    .replace(/\\[/g, '.')\r\n    .replace(/]/g, '')\r\n    .replace(VARIABLE_PATH, resolvePath(instance))\r\n    .split('.')\r\n\r\n  const cleanStep = (key) => key.replace(/^\\^/, '')\r\n\r\n  const _set = (item, steps, val) => {\r\n    const step = steps.shift()\r\n    if (steps.length > 0) {\r\n      if (Number.isInteger(+steps[0])) {\r\n        item[step] = []\r\n        return _set(item[step], steps, val)\r\n      } else if (!item[step]) {\r\n        // To force an integer as an object property, prefix it with ^\r\n        // If somehow you want to have a ^ in a key name, double it ^^\r\n        item[cleanStep(step)] = {}\r\n        return _set(item[cleanStep(step)], steps, val)\r\n      }\r\n    } else {\r\n      item[cleanStep(step)] = val\r\n    }\r\n  }\r\n\r\n  _set(obj, steps, value)\r\n\r\n  return obj\r\n}\r\n","import { watch } from '@vue/composition-api'\r\nimport { debounce } from '../utils'\r\n\r\nexport const prefix = (name) => `teddy:store:${name}`\r\nexport default {\r\n  handle({ name, store }) {\r\n    /* istanbul ignore next */\r\n    const localStorage = window.localStorage || global.localStorage || {}\r\n    /* istanbul ignore next */\r\n    if (localStorage) {\r\n      // Fetched saved state when exists\r\n      const cached = localStorage.getItem(prefix(name))\r\n      if (cached) store._state = { ...store._state, ...JSON.parse(cached) }\r\n      // Watch for mutations, save them\r\n      watch(\r\n        store._state,\r\n        debounce((newState, oldState) => {\r\n          if (newState !== oldState) {\r\n            localStorage.setItem(prefix(name), JSON.stringify(newState))\r\n          }\r\n        }, 500),\r\n        { immediate: true, deep: true }\r\n      )\r\n    }\r\n  },\r\n}\r\n","import { reactive, watch } from '@vue/composition-api'\r\n\r\nexport default {\r\n  handle({ store }) {\r\n    store._history = reactive([])\r\n    watch(\r\n      store._state,\r\n      (newState) => {\r\n        store._history.push(newState)\r\n      },\r\n      { immediate: true, deep: true }\r\n    )\r\n  },\r\n}\r\n","import { reactive } from '@vue/composition-api'\r\nimport { prefix } from './cache'\r\n\r\nexport default {\r\n  handle({ name, store }) {\r\n    /* istanbul ignore next */\r\n    if (window) {\r\n      window.addEventListener('storage', (e) => {\r\n        if (e.key === prefix(name)) {\r\n          store._state = reactive({ ...store._state, ...JSON.parse(e.newValue) })\r\n        }\r\n      })\r\n    }\r\n  },\r\n}\r\n","import { computed, reactive, ref, isRef, watch } from '@vue/composition-api'\r\n\r\nimport * as utils from './utils'\r\n\r\nimport CachePlugin from './plugins/cache'\r\nimport HistoryPlugin from './plugins/history'\r\nimport SyncPlugin from './plugins/sync'\r\n\r\nfunction getInstance(...solutions) {\r\n  const instanceSolution = solutions.find((s) => s && s instanceof TeddyStore)\r\n  const contextSolution = solutions.find((s) => s && '$teddy' in s && s.$teddy instanceof TeddyStore)\r\n  const solution = instanceSolution || (contextSolution ? contextSolution.$teddy : undefined)\r\n  if (!solution) {\r\n    /* istanbul ignore next */\r\n    throw new Error(`Couldn't find any proper instance!`)\r\n  }\r\n  return solution\r\n}\r\n\r\nexport default class TeddyStore {\r\n  constructor() {\r\n    this._stores = reactive({})\r\n    this._plugins = reactive({\r\n      cache: CachePlugin,\r\n      history: HistoryPlugin,\r\n      sync: SyncPlugin,\r\n    })\r\n  }\r\n\r\n  add(name, store) {\r\n    // eslint-disable-next-line no-unused-vars\r\n    const { _state: A, state: B, methods: C, watchers: D, ...others } = store\r\n\r\n    const { _state, state } = TeddyStore.createState(store._state || store.state || {})\r\n    this._stores = {\r\n      ...this._stores,\r\n      [name]: reactive({\r\n        _state,\r\n        state,\r\n        ...(store.methods || {}),\r\n        ...others,\r\n      }),\r\n    }\r\n\r\n    const watchers = []\r\n    if (Array.isArray(store.watchers)) {\r\n      watchers.push(...store.watchers)\r\n    } else if (store.watcher) {\r\n      watchers.push(store.watcher)\r\n    }\r\n\r\n    for (let watcher of watchers) {\r\n      if (typeof watcher === 'function') {\r\n        watch(this._stores[name].state, watcher, { deep: true })\r\n      } else if (watcher && typeof watcher === 'object' && 'handler' in watcher) {\r\n        const { handler, path, paths = [], ...options } = watcher\r\n        if (path) {\r\n          // console.log(\"utils.get(this._stores[name].state, path)\", utils.get(this._stores[name].state, path));\r\n          watch(() => utils.get(this._stores[name].state, path), handler, { deep: true, ...options })\r\n        } else if (paths.length > 0) {\r\n          watch(\r\n            paths.map((p) => () => utils.get(this._stores[name].state, p)),\r\n            handler,\r\n            { deep: true, ...options }\r\n          )\r\n        } else {\r\n          watch(() => this._stores[name].state, handler, { deep: true, ...options })\r\n        }\r\n      }\r\n    }\r\n\r\n    return this\r\n  }\r\n\r\n  use(plugin = {}) {\r\n    if (typeof plugin.install === 'function') plugin.install(this)\r\n    if (typeof plugin.handle === 'function') Object.keys(this._stores).map((name) => plugin.handle.call(this, { name, store: this._stores[name] }))\r\n    return this\r\n  }\r\n\r\n  activate(pluginNames = []) {\r\n    if (!Array.isArray(pluginNames)) pluginNames = [pluginNames]\r\n    for (let pluginName of pluginNames) {\r\n      if (pluginName in this._plugins) {\r\n        this.use(this._plugins[pluginName])\r\n      }\r\n    }\r\n    return this\r\n  }\r\n\r\n  install(VueInstance) {\r\n    VueInstance.prototype.$Teddy = TeddyStore\r\n    VueInstance.prototype.$teddy = this\r\n  }\r\n\r\n  get stores() {\r\n    return this._stores\r\n  }\r\n\r\n  static createState(stateObj = {}) {\r\n    const _state = isRef(stateObj) ? stateObj : ref(stateObj)\r\n    /* Until it's made available by Vue 3, be careful with { state } as it can be deeply mutable*/\r\n    // const state = readonly(() => _state.value)\r\n    const state = computed(() => _state.value)\r\n    return { _state, state }\r\n  }\r\n\r\n  get(name, path) {\r\n    return TeddyStore.get.call(this, name, path)\r\n  }\r\n\r\n  static get(name, path, context) {\r\n    context = context || this\r\n    return function get() {\r\n      const _instance = getInstance(this, context)\r\n      try {\r\n        return utils.get(_instance.stores[name].state, path, undefined, context)\r\n      } catch (error) {\r\n        /* istanbul ignore next */\r\n        throw new Error(`Couldn't compute (get) path '${path}' for '${name}'`)\r\n      }\r\n    }\r\n  }\r\n\r\n  set(name, path) {\r\n    return TeddyStore.set.call(this, name, path)\r\n  }\r\n\r\n  static set(name, path, context) {\r\n    context = context || this\r\n    return function set(value) {\r\n      const _instance = getInstance(this, context)\r\n      try {\r\n        utils.set(_instance.stores[name]._state, path, value, context)\r\n      } catch (error) {\r\n        /* istanbul ignore next */\r\n        throw new Error(`Couldn't compute (set) path '${path}' for '${name}'`)\r\n      }\r\n    }\r\n  }\r\n\r\n  compute(name, path) {\r\n    return TeddyStore.compute.call(this, name, path)\r\n  }\r\n\r\n  static compute(name, path) {\r\n    const get = TeddyStore.get.call(this, name, path)\r\n    const set = TeddyStore.set.call(this, name, path)\r\n    return {\r\n      get,\r\n      set,\r\n    }\r\n  }\r\n}\r\n"],"names":["const","let","this","utils.get","get","set","utils.set"],"mappings":";;;AAAAA,IAAM,aAAa,GAAG,aAAY;AAClC;AACA,SAAS,WAAW,CAAC,QAAQ,EAAE;AAC/B,EAAE,iBAAQ,IAAI,EAAK;AACnB,IAAIA,IAAM,YAAY,GAAG,GAAG,CAAC,QAAQ,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE,EAAC;AAChE,IAAI,IAAI,CAAC,QAAQ,EAAE,QAAQ,CAAC,CAAC,QAAQ,CAAC,OAAO,YAAY,CAAC,EAAE;AAC5D,MAAM,OAAO,YAAY;AACzB,KAAK,MAAM;AACX;AACA,MAAM,MAAM,IAAI,KAAK,eAAwC,EAAE,YAAa,CAAC,EAAE;AAC/E,KAAK;AACL,GAAG;AACH,CAAC;AACD;AACO,SAAS,QAAQ,CAAC,EAAE,EAAE,IAAU,EAAE;6BAAR,GAAG;AAAM;AAC1C,EAAEC,IAAI,QAAO;AACb,EAAE,OAAO,WAAkB;;;;AAAC;AAC5B,IAAI,YAAY,CAAC,OAAO,EAAC;AACzB,IAAI,OAAO,GAAG,UAAU,aAAO;AAC/B,MAAM,EAAE,CAAC,KAAK,CAACC,MAAI,EAAE,IAAI,EAAC;AAC1B,KAAK,EAAE,IAAI,EAAC;AACZ,GAAG;AACH,CAAC;AACD;AACO,SAAS,GAAG,CAAC,GAAG,EAAE,IAAI,EAAE,YAAY,EAAE,QAAQ,EAAE;AACvD,EAAE,OAAO,MAAM,CAAC,IAAI,CAAC;AACrB,KAAK,OAAO,CAAC,KAAK,EAAE,GAAG,CAAC;AACxB,KAAK,OAAO,CAAC,IAAI,EAAE,EAAE,CAAC;AACtB,KAAK,OAAO,CAAC,aAAa,EAAE,WAAW,CAAC,QAAQ,CAAC,CAAC;AAClD,KAAK,KAAK,CAAC,GAAG,CAAC;AACf,KAAK,MAAM,WAAE,GAAG,EAAE,CAAC,EAAK;AACxB,MAAM,IAAI;AACV,QAAQ,GAAG,GAAG,GAAG,CAAC,CAAC,CAAC,KAAK,SAAS,GAAG,YAAY,GAAG,GAAG,CAAC,CAAC,EAAC;AAC1D,OAAO,CAAC,OAAO,CAAC,EAAE;AAClB;AACA,QAAQ,OAAO,YAAY;AAC3B,OAAO;AACP,MAAM,OAAO,GAAG;AAChB,KAAK,EAAE,GAAG,CAAC;AACX,CAAC;AACD;AACO,SAAS,GAAG,CAAC,GAAG,EAAE,IAAI,EAAE,KAAK,EAAE,QAAQ,EAAE;AAChD,EAAEF,IAAM,KAAK,GAAG,MAAM,CAAC,IAAI,CAAC;AAC5B,KAAK,OAAO,CAAC,KAAK,EAAE,GAAG,CAAC;AACxB,KAAK,OAAO,CAAC,IAAI,EAAE,EAAE,CAAC;AACtB,KAAK,OAAO,CAAC,aAAa,EAAE,WAAW,CAAC,QAAQ,CAAC,CAAC;AAClD,KAAK,KAAK,CAAC,GAAG,EAAC;AACf;AACA,EAAEA,IAAM,SAAS,aAAI,GAAG,WAAK,GAAG,CAAC,OAAO,CAAC,KAAK,EAAE,EAAE,KAAC;AACnD;AACA,EAAEA,IAAM,IAAI,aAAI,IAAI,EAAE,KAAK,EAAE,GAAG,EAAK;AACrC,IAAIA,IAAM,IAAI,GAAG,KAAK,CAAC,KAAK,GAAE;AAC9B,IAAI,IAAI,KAAK,CAAC,MAAM,GAAG,CAAC,EAAE;AAC1B,MAAM,IAAI,MAAM,CAAC,SAAS,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,EAAE;AACvC,QAAQ,IAAI,CAAC,IAAI,CAAC,GAAG,GAAE;AACvB,QAAQ,OAAO,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,KAAK,EAAE,GAAG,CAAC;AAC3C,OAAO,MAAM,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE;AAC9B;AACA;AACA,QAAQ,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC,GAAG,GAAE;AAClC,QAAQ,OAAO,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC,EAAE,KAAK,EAAE,GAAG,CAAC;AACtD,OAAO;AACP,KAAK,MAAM;AACX,MAAM,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC,GAAG,IAAG;AACjC,KAAK;AACL,IAAG;AACH;AACA,EAAE,IAAI,CAAC,GAAG,EAAE,KAAK,EAAE,KAAK,EAAC;AACzB;AACA,EAAE,OAAO,GAAG;AACZ;;ACnEOA,IAAM,MAAM,aAAI,IAAI,6BAAoB,SAAM;AACrD,kBAAe;AACf,EAAE,uBAAM,IAAgB,EAAE;wBAAT;;AAAU;AAC3B;AACA,IAAIA,IAAM,YAAY,GAAG,MAAM,CAAC,YAAY,IAAI,MAAM,CAAC,YAAY,IAAI,GAAE;AACzE;AACA,IAAI,IAAI,YAAY,EAAE;AACtB;AACA,MAAMA,IAAM,MAAM,GAAG,YAAY,CAAC,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,EAAC;AACvD,MAAM,IAAI,MAAM,IAAE,KAAK,CAAC,MAAM,GAAG,kBAAK,KAAK,CAAC,MAAM,EAAK,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,IAAE;AAC3E;AACA,MAAM,KAAK;AACX,QAAQ,KAAK,CAAC,MAAM;AACpB,QAAQ,QAAQ,WAAE,QAAQ,EAAE,QAAQ,EAAK;AACzC,UAAU,IAAI,QAAQ,KAAK,QAAQ,EAAE;AACrC,YAAY,YAAY,CAAC,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,EAAE,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,EAAC;AACxE,WAAW;AACX,SAAS,EAAE,GAAG,CAAC;AACf,QAAQ,EAAE,SAAS,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE;AACvC,QAAO;AACP,KAAK;AACL,GAAG;AACH;;ACvBA,oBAAe;AACf,EAAE,uBAAM,IAAU,EAAE;;AAAC;AACrB,IAAI,KAAK,CAAC,QAAQ,GAAG,QAAQ,CAAC,EAAE,EAAC;AACjC,IAAI,KAAK;AACT,MAAM,KAAK,CAAC,MAAM;AAClB,gBAAO,QAAQ,EAAK;AACpB,QAAQ,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,QAAQ,EAAC;AACrC,OAAO;AACP,MAAM,EAAE,SAAS,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE;AACrC,MAAK;AACL,GAAG;AACH;;ACVA,iBAAe;AACf,EAAE,uBAAM,IAAgB,EAAE;wBAAT;;AAAU;AAC3B;AACA,IAAI,IAAI,MAAM,EAAE;AAChB,MAAM,MAAM,CAAC,gBAAgB,CAAC,SAAS,YAAG,CAAC,EAAK;AAChD,QAAQ,IAAI,CAAC,CAAC,GAAG,KAAK,MAAM,CAAC,IAAI,CAAC,EAAE;AACpC,UAAU,KAAK,CAAC,MAAM,GAAG,QAAQ,CAAC,kBAAK,KAAK,CAAC,MAAM,EAAK,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAE,EAAC;AACjF,SAAS;AACT,OAAO,EAAC;AACR,KAAK;AACL,GAAG;AACH;;;ACPA;AACA,SAAS,WAAW,GAAe;;;AAAC;AACpC,EAAEA,IAAM,gBAAgB,GAAG,SAAS,CAAC,IAAI,WAAE,CAAC,WAAK,CAAC,IAAI,CAAC,YAAY,aAAU,EAAC;AAC9E,EAAEA,IAAM,eAAe,GAAG,SAAS,CAAC,IAAI,WAAE,CAAC,WAAK,CAAC,IAAI,QAAQ,IAAI,CAAC,IAAI,CAAC,CAAC,MAAM,YAAY,aAAU,EAAC;AACrG,EAAEA,IAAM,QAAQ,GAAG,gBAAgB,KAAK,eAAe,GAAG,eAAe,CAAC,MAAM,GAAG,SAAS,EAAC;AAC7F,EAAE,IAAI,CAAC,QAAQ,EAAE;AACjB;AACA,IAAI,MAAM,IAAI,KAAK,CAAC,oCAAoC,CAAC;AACzD,GAAG;AACH,EAAE,OAAO,QAAQ;AACjB,CAAC;AACD;IACqB,UAAU,GAC7B,mBAAW,GAAG;AAChB,EAAI,IAAI,CAAC,OAAO,GAAG,QAAQ,CAAC,EAAE,EAAC;AAC/B,EAAI,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;AAC7B,IAAM,KAAK,EAAE,WAAW;AACxB,IAAM,OAAO,EAAE,aAAa;AAC5B,IAAM,IAAI,EAAE,UAAU;AACtB,GAAK,EAAC;AACJ;;4DAAC;AACH;qBACE,oBAAI,IAAI,EAAE,KAAK,EAAE;;;AAAC;AACpB;AACA,EAAoB;IAAU;IAAY;IAAa;IAAG;IAAG,kBAAgB;AAC7E;AACA,SAA2B,GAAG,UAAU,CAAC,WAAW,CAAC,KAAK,CAAC,MAAM,IAAI,KAAK,CAAC,KAAK,IAAI,EAAE;IAA1E;IAAQ,sBAAmE;AACvF,EAAI,IAAI,CAAC,OAAO,GAAG,kBACV,IAAI,CAAC,OAAO;AACrB,mBAAM,CAAC,IAAI,IAAG,QAAQ,CAAC,2BACf,MAAM;AACd,aAAQ,MAAK;AACb,OAAY,KAAK,CAAC,OAAO,IAAI,EAAE;AAC/B,MAAW,MAAM,CACV,UACF;AACL;AACA,EAAIA,IAAM,QAAQ,GAAG,GAAE;AACvB,EAAI,IAAI,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,QAAQ,CAAC,EAAE;AACvC,IAAM,QAAQ,CAAC,UAAI,WAAI,KAAK,CAAC,QAAQ,EAAC;AACtC,GAAK,MAAM,IAAI,KAAK,CAAC,OAAO,EAAE;AAC9B,IAAM,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,OAAO,EAAC;AAClC,GAAK;AACL;AACA,EAAI,KAAKC,IAAI,OAAO,IAAI,QAAQ,EAAE;AAClC,IAAM,IAAI,OAAO,OAAO,KAAK,UAAU,EAAE;AACzC,MAAQ,KAAK,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,KAAK,EAAE,OAAO,EAAE,EAAE,IAAI,EAAE,IAAI,EAAE,EAAC;AAChE,KAAO,MAAM,IAAI,OAAO,IAAI,OAAO,OAAO,KAAK,QAAQ,IAAI,SAAS,IAAI,OAAO,EAAE;AACjF,MAAgB;QAAS;mEAAc;QAAI;QAAG,mBAAmB;AACjE,MAAQ,IAAI,IAAI,EAAE;AAClB;AACA,QAAU,KAAK,sBAAOE,GAAS,CAACD,MAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,KAAK,EAAE,IAAI,IAAC,EAAE,OAAO,EAAE,mBAAE,IAAI,EAAE,KAAI,EAAK,OAAO,CAAE,EAAC;AACrG,OAAS,MAAM,IAAI,KAAK,CAAC,MAAM,GAAG,CAAC,EAAE;AACrC,QAAU,KAAK;AACf,UAAY,KAAK,CAAC,GAAG,WAAE,CAAC,gCAAWC,GAAS,CAACD,MAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,KAAK,EAAE,CAAC,OAAC,CAAC;AAC1E,UAAY,OAAO;AACnB,UAAY,mBAAE,IAAI,EAAE,KAAI,EAAK,OAAO,CAAE;AACtC,UAAW;AACX,OAAS,MAAM;AACf,QAAU,KAAK,sBAAOA,MAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,QAAK,EAAE,OAAO,EAAE,mBAAE,IAAI,EAAE,KAAI,EAAK,OAAO,CAAE,EAAC;AACpF,OAAS;AACT,KAAO;AACP,GAAK;AACL;AACA,EAAI,OAAO,IAAI;AACb,EAAC;AACH;qBACE,oBAAI,MAAW,EAAE;;mCAAP,GAAG;AAAK;AACpB,EAAI,IAAI,OAAO,MAAM,CAAC,OAAO,KAAK,UAAU,IAAE,MAAM,CAAC,OAAO,CAAC,IAAI,IAAC;AAClE,EAAI,IAAI,OAAO,MAAM,CAAC,MAAM,KAAK,UAAU,IAAE,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,GAAG,WAAE,IAAI,WAAK,MAAM,CAAC,MAAM,CAAC,IAAI,CAACA,MAAI,EAAE,QAAE,IAAI,EAAE,KAAK,EAAEA,MAAI,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE,IAAC,IAAC;AACnJ,EAAI,OAAO,IAAI;AACb,EAAC;AACH;qBACE,8BAAS,WAAgB,EAAE;6CAAP,GAAG;AAAK;AAC9B,EAAI,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,WAAW,CAAC,IAAE,WAAW,GAAG,CAAC,WAAW,IAAC;AAChE,EAAI,KAAKD,IAAI,UAAU,IAAI,WAAW,EAAE;AACxC,IAAM,IAAI,UAAU,IAAI,IAAI,CAAC,QAAQ,EAAE;AACvC,MAAQ,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,QAAQ,CAAC,UAAU,CAAC,EAAC;AAC3C,KAAO;AACP,GAAK;AACL,EAAI,OAAO,IAAI;AACb,EAAC;AACH;qBACE,4BAAQ,WAAW,EAAE;AACvB,EAAI,WAAW,CAAC,SAAS,CAAC,MAAM,GAAG,WAAU;AAC7C,EAAI,WAAW,CAAC,SAAS,CAAC,MAAM,GAAG,KAAI;AACrC,EAAC;AACH;AACE,mBAAI,yBAAS;AACf,EAAI,OAAO,IAAI,CAAC,OAAO;AACrB,EAAC;AACH;AACE,WAAO,oCAAY,QAAa,EAAE;uCAAP,GAAG;AAAK;AACrC,EAAID,IAAM,MAAM,GAAG,KAAK,CAAC,QAAQ,CAAC,GAAG,QAAQ,GAAG,GAAG,CAAC,QAAQ,EAAC;AAC7D;AACA;AACA,EAAIA,IAAM,KAAK,GAAG,QAAQ,sBAAO,MAAM,CAAC,QAAK,EAAC;AAC9C,EAAI,OAAO,UAAE,MAAM,SAAE,KAAK,EAAE;AAC1B,EAAC;AACH;qBACE,oBAAI,IAAI,EAAE,IAAI,EAAE;AAClB,EAAI,OAAO,UAAU,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC;AAC9C,EAAC;AACH;AACE,WAAO,sBAAI,IAAI,EAAE,IAAI,EAAE,OAAO,EAAE;AAClC,EAAI,OAAO,GAAG,OAAO,IAAI,KAAI;AAC7B,EAAI,OAAO,SAASI,KAAG,GAAG;AAC1B,IAAMJ,IAAM,SAAS,GAAG,WAAW,CAAC,IAAI,EAAE,OAAO,EAAC;AAClD,IAAM,IAAI;AACV,MAAQ,OAAOG,GAAS,CAAC,SAAS,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,KAAK,EAAE,IAAI,EAAE,SAAS,EAAE,OAAO,CAAC;AAChF,KAAO,CAAC,OAAO,KAAK,EAAE;AACtB;AACA,MAAQ,MAAM,IAAI,KAAK,oCAAiC,IAAI,eAAU,IAAI,QAAI;AAC9E,KAAO;AACP,GAAK;AACH,EAAC;AACH;qBACE,oBAAI,IAAI,EAAE,IAAI,EAAE;AAClB,EAAI,OAAO,UAAU,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC;AAC9C,EAAC;AACH;AACE,WAAO,sBAAI,IAAI,EAAE,IAAI,EAAE,OAAO,EAAE;AAClC,EAAI,OAAO,GAAG,OAAO,IAAI,KAAI;AAC7B,EAAI,OAAO,SAASE,KAAG,CAAC,KAAK,EAAE;AAC/B,IAAML,IAAM,SAAS,GAAG,WAAW,CAAC,IAAI,EAAE,OAAO,EAAC;AAClD,IAAM,IAAI;AACV,MAAQM,GAAS,CAAC,SAAS,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,OAAO,EAAC;AACtE,KAAO,CAAC,OAAO,KAAK,EAAE;AACtB;AACA,MAAQ,MAAM,IAAI,KAAK,oCAAiC,IAAI,eAAU,IAAI,QAAI;AAC9E,KAAO;AACP,GAAK;AACH,EAAC;AACH;qBACE,4BAAQ,IAAI,EAAE,IAAI,EAAE;AACtB,EAAI,OAAO,UAAU,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC;AAClD,EAAC;AACH;AACE,WAAO,4BAAQ,IAAI,EAAE,IAAI,EAAE;AAC7B,EAAIN,IAAM,GAAG,GAAG,UAAU,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,EAAE,IAAI,EAAE,IAAI,EAAC;AACrD,EAAIA,IAAM,GAAG,GAAG,UAAU,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,EAAE,IAAI,EAAE,IAAI,EAAC;AACrD,EAAI,OAAO;AACX,SAAM,GAAG;AACT,SAAM,GAAG;AACT,GAAK;AACH;;;;;;"}