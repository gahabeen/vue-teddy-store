/*!
  * vue-teddy-store v0.2.33
  * (c) 2020 Gabin Desserprit
  * @license MIT
  */
/*!
  * vue-teddy-store v0.2.33
  * (c) 2020 Gabin Desserprit
  * @license MIT
  */
var VueTeddyStore=function(e,t,s,r){"use strict";var a="default"in t?t.default:t;r=r&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r;const o=(e,t)=>`teddy:${e}:${t}`;var n={store(e,t){const s=Y(e,t);if(s.features.cache)return;const r=window.localStorage||global.localStorage||{};if(r){const a=r.getItem(o(e,t));a&&(s.state=JSON.parse(a)),C({space:e,name:t},{handler(s){r.setItem(o(e,t),JSON.stringify(s))},immediate:!0,deep:!0}),s.features.cache=!0}}},c={store(e,s){const r=Y(e,s);r.features.history||(r.features.history={},r.features.history.stack=t.reactive([]),C({space:e,name:s},{handler(e){r.features.history.stack.push({state:e,ts:(new Date).getTime()})},immediate:!0,deep:!0}),r.features.history.installed=!0)}},i={store(e,t){const s=Y(e,t);s.features.sync||(s.features.sync={},window&&window.addEventListener("storage",e=>{e.key===o(t)&&(s.state={...s.state,...JSON.parse(e.newValue)})}),s.features.sync.installed=!0)}},d=Object.freeze({__proto__:null,cache:n,history:c,sync:i});function u(e){if(!s.isObject(e)||s.isObject(e)&&!("value"in e))return!1;return"function"==typeof Object.getOwnPropertyDescriptor(e,"value").get}function p(e,t,r){return s.isValidKey(t)&&(s.isObject(e)||Array.isArray(e))?u(e)&&"value"in e&&t in e.value?(e.value[t]=r,e.value[t]):Array.isArray(e)?(e.splice(+t,1,r),e[t]):s.isObject(e)?(e[t]=r,e[t]):void 0:e&&null==t?(u(e)&&"value"in e?e.value=r:s.isObject(r)?Object.assign(e,r):e=r,e):void console.log("Couldn't not set "+t)}function y(e,t){return s.isValidKey(t)?u(e)?t in e.value?e.value[t]:e.value:s.isObject(e)||Array.isArray(e)?e[t]:void 0:e&&void 0===t?u(e)?e.value:e:void 0}function l(e,t){return!(!s.isObject(e)&&!Array.isArray(e))&&(!!s.isValidKey(t)&&(!!(u(e)&&e.value&&t in e.value)||(!(!e||!(t in e))||void 0)))}function f(e=[]){return["_state",...e]}const h=s.makeSet({setProp:p,getProp:y,hasProp:l,afterGetSteps:f}),m=s.makeHas({getProp:y,hasProp:l,afterGetSteps:f}),g=s.makeGet({getProp:y,hasProp:l,afterGetSteps:f}),S=s.makeSet({setProp:p,getProp:y,hasProp:l}),v=s.makeHas({getProp:y,hasProp:l}),j=s.makeGet({getProp:y,hasProp:l});var b=Object.freeze({__proto__:null,teddySet:h,teddyHas:m,teddyGet:g,set:S,has:v,get:j});r.use(a);const O=Symbol(),k=Symbol(),T={__options:{devtools:!0},spaces:{}},w=(e="$",t="@")=>{let r=e,a=t;if("string"==typeof e&&e.includes(".")){const t=e.split(".");r=t[0]||r,a=t[1]||a}else e&&s.isObject(e)?(r=e.space||"$",a=e.name||a):t&&s.isObject(t)&&(r=t.space||r,a=t.name||"@");return"string"==typeof r&&(r=r.trim()),"string"==typeof a&&(a=a.trim()),{space:r,name:a}},A=(e,t)=>{const r=w(s.isObject(e)?e:{name:e});t=t||{};const a=Y(r);return $(r,t.state),V(r,t.getters),x(r,t.actions),C(r,t.watchers),a},P=(e,s)=>t.isRef(s)?s:t.ref(s),_=(e,t,s={})=>(s._state=P(0,t),"state"in s||Object.defineProperty(s,"state",{get:()=>s._state.value,set:e=>{s._state.value=e},enumerable:!0}),s),$=(e,t)=>{const s=Y(e);_(0,t,s)},G=(e,t)=>{const s=Y(e);return t=t||{},Object.keys(t).reduce((e,r)=>(u(t[r])?e[r]=t[r]:"function"==typeof t[r]&&(e[r]=ae(()=>t[r](s))),e),{})},V=(e,t)=>{const s=Y(e);return s.getters={...s.getters||{},...G(e,t)},s},W=(e,t)=>{const s=Y(e);return t=t||{},Object.keys(t).reduce((e,r)=>("function"==typeof t[r]&&(e[r]=(...e)=>t[r](s,...e)),e),{})},x=(e,t)=>{const s=Y(e);return s.actions={...s.actions||{},...W(e,t)},s},z=(e,s)=>{const{name:r}=w(e),a=Y(e),o=[];return Array.isArray(s)?o.push(...s):s&&o.push(s),0===o.length?[]:o.reduce((e,s)=>{const o=(s,r,a,o)=>{const n=t.watch(r,a,{deep:!0,...o});e.push({path:s,handler:a,options:o,unwatch:n})};if("function"==typeof s)o("state",()=>a.state,s,{deep:!0});else if(s&&"object"==typeof s&&"handler"in s){const{handler:e,path:t,paths:n=[],...c}=s;"string"==typeof t?o(t,()=>g(a,t),e,{deep:!0,...c}):n.length>0?o(n.map(e=>[r,e].filter(Boolean).filter(e=>e.length>0).join(".")),n.map(e=>()=>g(a,e)),e,{deep:!0,...c}):o("state",()=>a.state,e,{deep:!0,...c})}return e},[])},C=(e,t)=>{const s=Y(e);return s.watchers=[...s.watchers||[],...z(e,t)],s},H=e=>{const{space:t,name:s}=w(e);return void 0!==s?t in T.spaces&&"stores"in T.spaces[t]&&s in T.spaces[t].stores:t in T.spaces},J=e=>{const{space:t,name:s}=w(e),r=q(t);s in r.stores&&delete r.stores[s]},K=e=>{},N=(e,t,...s)=>{const{store:r}=Z(e);if(t in r.actions)try{return r.actions[t](...s)}catch(e){console.error(`Something went wrong with the action '${t}'`)}else console.warn(`Couldn't find the action '${t}' to run.`)},D=(e,t,s)=>{const r=Y(e);return m(r,t,s)},F=(e,t,s,r)=>{const a=Y(e);return g(a,t,s)||r},I=(e,t,s,r)=>function(){return F(e,t,s||this,r)},M=(e,t,s,r)=>{const a=Y(e);h(a,t,s,r)},B=(e,t,s)=>function(r){M(e,t,r,s||this)},E=(e,t,r)=>{const a=(t,s)=>({get:I(e,t,s),set:B(e,t,s)});return Array.isArray(t)?t.reduce((e,t)=>(e[t]=a(t,r),e),{}):s.isObject(t)?Object.keys(t).reduce((e,s)=>(e[s]=a(t[s],r),e),{}):a(t,r)},L=(e={})=>{"function"==typeof e.teddy&&e.teddy(T);for(const t of Object.keys(T.spaces||{})){"function"==typeof e.space&&e.space(t);for(const s of Object.keys(T.spaces[t].stores||{}))"function"==typeof e.store&&e.store(t,s)}},R=(e=(e=>e))=>({setStore:e(A),makeState:e(P),setState:e($),applyState:e(_),makeGetters:e(G),setGetters:e(V),makeActions:e(W),setActions:e(x),makeWatchers:e(z),setWatchers:e(C),exists:e(H),remove:e(J),reset:e(K),run:e(N),has:e(D),get:e(F),getter:e(I),set:e(M),setter:e(B),sync:e(E)}),q=(e="$")=>(e in T.spaces||(T.spaces[e]={}),T.spaces[e]),Q=(e="$")=>({store:q(e),...R(t=>(...s)=>t({space:e,name:"@"},...s))}),U=(e="@")=>Y("$",e),X=(e="@")=>({store:U(e),...R(t=>(...s)=>t({name:e,space:"$"},...s))}),Y=(e,t)=>{const{space:s,name:r}=w(e,t);return q(s),"stores"in T.spaces[s]||(T.spaces[s].stores={}),r in T.spaces[s].stores||(T.spaces[s].stores[r]={getters:{},actions:{},watchers:[],options:{},features:{}},_(0,{},T.spaces[s].stores[r])),T.spaces[s].stores[r]},Z=(e="$",t="@")=>({store:Y(e,t),...R(s=>(...r)=>s({space:e,name:t},...r))}),ee=(e="$")=>{t.provide(O,Q(e))},te=(...e)=>{t.provide(k,Z(...e))},se=()=>{t.inject(O)},re=()=>{t.inject(k)},ae=e=>{if(s.isObject(e)){const s="get"in e&&"function"==typeof e.get,r="set"in e&&"function"==typeof e.set;return s||r?t.computed(e):Object.keys(e).reduce((s,r)=>(s[r]=t.computed(e[r]),s),{})}return t.computed(e)};var oe=Object.freeze({__proto__:null,accessors:b,features:d,Teddy:O,TeddyStore:k,Teddies:T,setStore:A,makeState:P,applyState:_,setState:$,makeGetters:G,setGetters:V,makeActions:W,setActions:x,makeWatchers:z,setWatchers:C,exists:H,remove:J,reset:K,run:N,has:D,get:F,getter:I,set:M,setter:B,sync:E,setFeature:L,mapMethods:R,getTeddy:q,useTeddy:Q,getStore:U,useStore:X,getTeddyStore:Y,useTeddyStore:Z,provideTeddy:ee,provideTeddyStore:te,injectTeddy:se,injectTeddyStore:re,computed:ae});return e.Teddies=T,e.Teddy=O,e.TeddyStore=k,e.accessors=b,e.applyState=_,e.computed=ae,e.exists=H,e.features=d,e.get=F,e.getStore=U,e.getTeddy=q,e.getTeddyStore=Y,e.getter=I,e.has=D,e.injectTeddy=se,e.injectTeddyStore=re,e.install=e=>{e.prototype.$teddy=oe},e.makeActions=W,e.makeGetters=G,e.makeState=P,e.makeWatchers=z,e.mapMethods=R,e.provideTeddy=ee,e.provideTeddyStore=te,e.remove=J,e.reset=K,e.run=N,e.set=M,e.setActions=x,e.setFeature=L,e.setGetters=V,e.setState=$,e.setStore=A,e.setWatchers=C,e.setter=B,e.sync=E,e.useStore=X,e.useTeddy=Q,e.useTeddyStore=Z,e}({},vueCompositionApi,objectStringPath,Vue);
