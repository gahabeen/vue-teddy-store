/*!
  * vue-teddy-store v0.2.38
  * (c) 2020 Gabin Desserprit
  * @license MIT
  */
/*!
  * vue-teddy-store v0.2.38
  * (c) 2020 Gabin Desserprit
  * @license MIT
  */
var VueTeddyStore=function(e,t,s,r,a,n){"use strict";var o="default"in t?t.default:t;r=r&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r,a=a&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a,n=n&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n;const c=(e,t)=>`teddy:${e}:${t}`;var i={store(e,t){const s=ne({space:e,name:t});if(s.features.cache)return;const r=window.localStorage||global.localStorage||{};if(r){const a=r.getItem(c(e,t));a&&(s.state=JSON.parse(a)),I({space:e,name:t},{handler(s){r.setItem(c(e,t),JSON.stringify(s))},immediate:!0,deep:!0}),s.features.cache=!0}}},u={store(e,s){const r=ne({space:e,name:s});r.features.history||(r.features.history={},r.features.history.stack=t.reactive([]),I({space:e,name:s},{handler(e){r.features.history.stack.push({state:e,ts:(new Date).getTime()})},immediate:!0,deep:!0}),r.features.history.installed=!0)}},p={store(e,t){const s=ne({space:e,name:t});s.features.sync||(s.features.sync={},window&&window.addEventListener("storage",e=>{e.key===c(t)&&(s.state={...s.state,...JSON.parse(e.newValue)})}),s.features.sync.installed=!0)}},d=Object.freeze({__proto__:null,cache:i,history:u,sync:p});function l(e){if(!s.isObject(e)||s.isObject(e)&&!("value"in e))return!1;return"function"==typeof Object.getOwnPropertyDescriptor(e,"value").get}const y={},f=(e,s)=>(n,o=[],c={},i={},u=(()=>null))=>{const{value:p}=((e,s)=>(n,o=[],c={},i={},u=(()=>null))=>{const p=o.join("."),d=r(JSON.parse(a(n,t.unref))),l=r(JSON.parse(a(i,t.unref))),f=`${e}/${s}//${p}//${l}`;if(d in y&&y[d].has(f))return{cache:!0,value:y[d].get(f)};{d in y||(y[d]=new Map);const e=u(n,o,c);return y[d].set(f,e),{cache:!1,value:e}}})(e,s)(n,o,c,i,u);return p};function h(e,t,r){return s.isValidKey(t)&&(s.isObject(e)||Array.isArray(e))?l(e)&&"value"in e&&t in e.value?(e.value[t]=r,e.value[t]):Array.isArray(e)?(e.splice(+t,1,r),e[t]):s.isObject(e)?(e[t]=r,e[t]):void 0:e&&null==t?(l(e)&&"value"in e?e.value=r:s.isObject(r)?Object.assign(e,r):e=r,e):void console.warn("Couldn't not set "+t)}function m(e,t){return s.isValidKey(t)?l(e)?t in e.value?e.value[t]:e.value:s.isObject(e)||Array.isArray(e)?e[t]:void 0:e&&void 0===t?l(e)?e.value:e:void 0}function g(e,t){return!(!s.isObject(e)&&!Array.isArray(e))&&(!!s.isValidKey(t)&&(!!(l(e)&&e.value&&t in e.value)||(!(!e||!(t in e))||void 0)))}function v(e,r,a,n){const o=t.unref(r),c=t.isRef(r);return Array.isArray(o)?(c?r.value.splice(+n,1):r.splice(+n,1),!0):!!s.isObject(o)&&(c?r.value=function(e,t=[]){return Object.keys(e).reduce((s,r)=>(t.includes(r)||(s[r]=e[r]),s),{})}(r.value,[n]):delete r[n],a.length,!0)}function S(e=[]){return"_state"!==e[0]?["_state",...e]:e}const j=s.makeSet({setProp:h,getProp:m,hasProp:g,afterGetSteps:S}),O=s.makeHas({getProp:m,hasProp:g,afterGetSteps:S}),b=(e,t)=>s.makeGet({getProp:m,hasProp:g,afterGetSteps:S,proxy:f(e,t)}),k=(e,t)=>s.makeRemove({get:b(e,t),getProp:m,hasProp:g,removeProp:v,afterGetSteps:S}),P=s.makeSet({setProp:h,getProp:m,hasProp:g}),w=s.makeHas({getProp:m,hasProp:g}),A=s.makeGet({getProp:m,hasProp:g}),_=s.makeRemove({get:A,getProp:m,hasProp:g});var T=Object.freeze({__proto__:null,teddySet:j,teddyHas:O,teddyGet:b,teddyRemove:k,set:P,has:w,get:A,remove:_});n.use(o);const G=Symbol(),$=Symbol(),V={__options:{devtools:!0},spaces:{}},W="$",J="@",N=e=>{let t,r;if(s.isObject(e))t="space"in e?e.space:W,r="name"in e?e.name:J;else if("string"==typeof e)if(e.includes(".")){let[s,a]=e.split(".");t=s,r=a}else if(e.includes("/")){let[s,a]=e.split("/");t=s,r=a}else t=W,r=e;return"string"==typeof t&&(t=t.trim(),0===t.length&&(t=void 0)),"string"==typeof r&&(r=r.trim(),0===r.length&&(r=void 0)),{space:t,name:r}},R=(e,t)=>{const s=N(e);t=t||{};const r=ne(s);return z(s,t.state),K(s,t.getters),D(s,t.actions),I(s,t.watchers),r},x=(e,s)=>t.isRef(s)?s:t.ref(s),H=(e,t,s={})=>(s._state=x(0,t),"state"in s||Object.defineProperty(s,"state",{get:()=>s._state.value,set:e=>{s._state.value=e},enumerable:!0}),s),z=(e,t)=>{const s=ne(e);H(0,t,s)},C=(e,t)=>{const s=ne(e);return t=t||{},Object.keys(t).reduce((e,r)=>(l(t[r])?e[r]=t[r]:"function"==typeof t[r]&&(e[r]=pe(()=>t[r](s))),e),{})},K=(e,t)=>{const s=ne(e);return s.getters={...s.getters||{},...C(e,t)},s},M=(e,t)=>{const s=ne(e);return t=t||{},Object.keys(t).reduce((e,r)=>("function"==typeof t[r]&&(e[r]=(...e)=>t[r](s,...e)),e),{})},D=(e,t)=>{const s=ne(e);return s.actions={...s.actions||{},...M(e,t)},s},F=(e,s)=>{const{space:r,name:a}=N(e),n=ne(e),o=[];return Array.isArray(s)?o.push(...s):s&&o.push(s),0===o.length?[]:o.reduce((e,s)=>{const o=(s,r,a,n)=>{const o=t.watch(r,a,{deep:!0,...n});e.push({path:s,handler:a,options:n,unwatch:o})};if("function"==typeof s)o("state",()=>n.state,s,{deep:!0});else if(s&&"object"==typeof s&&"handler"in s){const{handler:e,path:t,paths:c=[],...i}=s,u=e=>function(t,s){(void 0!==t&&void 0!==s||t!==s)&&e.call(this,t,s)};"string"==typeof t?o(t,()=>b(r,a)(n,t),u(e),{deep:!0,...i}):c.length>0?o(c.map(e=>[a,e].filter(Boolean).filter(e=>e.length>0).join(".")),c.map(e=>()=>b(r,a)(n,e)),u(e),{deep:!0,...i}):o("state",()=>n.state,u(e),{deep:!0,...i})}return e},[])},I=(e,t)=>{const s=ne(e);return s.watchers=[...s.watchers||[],...F(e,t)],s},B=e=>{const{space:t,name:s}=N(e);return void 0!==s?t in V.spaces&&"stores"in V.spaces[t]&&s in V.spaces[t].stores:t in V.spaces},E=e=>{},L=(e,t,...s)=>{const{store:r}=oe(e);if(t in r.actions)try{return r.actions[t](...s)}catch(e){console.error(`Something went wrong with the action '${t}'`),console.error(e)}else console.warn(`Couldn't find the action '${t}' to run.`)},q=(e,t,s)=>{const{space:r,name:a}=N(e),n=ne({space:r,name:a});return k(r,a)(n,t,s)},Q=(e,t,s)=>{const r=ne(e);return O(r,t,s)},U=(e,t,s,r)=>{const{space:a,name:n}=N(e),o=ne({space:a,name:n});return b(a,n)(o,t,s)||r},X=(e,t,s,r)=>function(){return U(e,t,s||this,r)},Y=(e,t,s,r)=>{const a=ne(e);j(a,t,s,r)},Z=(e,t,s)=>function(r){Y(e,t,r,s||this)},ee=(e,t,r)=>{const a=(t,s)=>({get:X(e,t,s),set:Z(e,t,s)});return Array.isArray(t)?t.reduce((e,t)=>(e[t]=a(t,r),e),{}):s.isObject(t)?Object.keys(t).reduce((e,s)=>(e[s]=a(t[s],r),e),{}):a(t,r)},te=(e={})=>{"function"==typeof e.teddy&&e.teddy(V);for(const t of Object.keys(V.spaces||{})){"function"==typeof e.space&&e.space(t);for(const s of Object.keys(V.spaces[t].stores||{}))"function"==typeof e.store&&e.store(t,s)}},se=(e=(e=>e))=>({setStore:e(R),makeState:e(x),setState:e(z),applyState:e(H),makeGetters:e(C),setGetters:e(K),makeActions:e(M),setActions:e(D),makeWatchers:e(F),setWatchers:e(I),exists:e(B),reset:e(E),run:e(L),remove:e(q),has:e(Q),get:e(U),getter:e(X),set:e(Y),setter:e(Z),sync:e(ee)}),re=(e=W)=>(e in V.spaces||(V.spaces[e]={}),V.spaces[e]),ae=(e=W)=>({store:re(e),...se(t=>(...s)=>t({space:e,name:J},...s))}),ne=e=>{const{space:t=W,name:s=J}=N(e);return re(t),"stores"in V.spaces[t]||(V.spaces[t].stores={}),s in V.spaces[t].stores||(V.spaces[t].stores[s]={getters:{},actions:{},watchers:[],options:{},features:{}},H(0,{},V.spaces[t].stores[s])),V.spaces[t].stores[s]},oe=e=>({store:ne(e),...se(t=>(...s)=>t(e,...s))}),ce=e=>{t.provide($,oe(e))},ie=()=>{t.inject(G)},ue=()=>{t.inject($)},pe=e=>{if(s.isObject(e)){const s="get"in e&&"function"==typeof e.get,r="set"in e&&"function"==typeof e.set;return s||r?t.computed(e):Object.keys(e).reduce((s,r)=>(s[r]=t.computed(e[r]),s),{})}return t.computed(e)};var de=Object.freeze({__proto__:null,accessors:T,features:d,Teddy:G,TeddyStore:$,Teddies:V,setStore:R,makeState:x,applyState:H,setState:z,makeGetters:C,setGetters:K,makeActions:M,setActions:D,makeWatchers:F,setWatchers:I,exists:B,reset:E,run:L,remove:q,has:Q,get:U,getter:X,set:Y,setter:Z,sync:ee,setFeature:te,mapMethods:se,getTeddy:re,useTeddy:ae,getStore:ne,useStore:oe,provideTeddyStore:ce,injectTeddy:ie,injectTeddyStore:ue,computed:pe});return e.Teddies=V,e.Teddy=G,e.TeddyStore=$,e.accessors=T,e.applyState=H,e.computed=pe,e.exists=B,e.features=d,e.get=U,e.getStore=ne,e.getTeddy=re,e.getter=X,e.has=Q,e.injectTeddy=ie,e.injectTeddyStore=ue,e.install=e=>{e.prototype.$teddy=de},e.makeActions=M,e.makeGetters=C,e.makeState=x,e.makeWatchers=F,e.mapMethods=se,e.provideTeddyStore=ce,e.remove=q,e.reset=E,e.run=L,e.set=Y,e.setActions=D,e.setFeature=te,e.setGetters=K,e.setState=z,e.setStore=R,e.setWatchers=I,e.setter=Z,e.sync=ee,e.useStore=oe,e.useTeddy=ae,e}({},vueCompositionApi,objectStringPath,getHash,stringify,Vue);
