/*!
  * vue-teddy-store v0.2.42
  * (c) 2020 Gabin Desserprit
  * @license MIT
  */
/*!
  * vue-teddy-store v0.2.42
  * (c) 2020 Gabin Desserprit
  * @license MIT
  */
var VueTeddyStore=function(e,t,s,r){"use strict";var a="default"in t?t.default:t;r=r&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r;const o=(e,t)=>`teddy:${e}:${t}`;var n={store(e,t){const s=te({space:e,name:t});if(s.features.cache)return;const r=window.localStorage||global.localStorage||{};if(r){const a=r.getItem(o(e,t));a&&(s.state=JSON.parse(a)),N({space:e,name:t},{handler(s){r.setItem(o(e,t),JSON.stringify(s))},immediate:!0,deep:!0}),s.features.cache=!0}}},c={store(e,s){const r=te({space:e,name:s});r.features.history||(r.features.history={},r.features.history.stack=t.reactive([]),N({space:e,name:s},{handler(e){r.features.history.stack.push({state:e,ts:(new Date).getTime()})},immediate:!0,deep:!0}),r.features.history.installed=!0)}},i={store(e,t){const s=te({space:e,name:t});s.features.sync||(s.features.sync={},window&&window.addEventListener("storage",r=>{r.key===o(e,t)&&(s.state={...s.state,...JSON.parse(r.newValue)})}),s.features.sync.installed=!0)}},u=Object.freeze({__proto__:null,cache:n,history:c,sync:i});function p(e){if(!s.isObject(e)||s.isObject(e)&&!("value"in e))return!1;return"function"==typeof Object.getOwnPropertyDescriptor(e,"value").get}function d(e,r,a){if(s.isObject(e)||Array.isArray(e)){if(s.isValidKey(r)){try{t.set(t.unref(e),r,a)}catch(t){console.error("Couldn't not set value: "+{obj:e,key:r,value:a})}return t.unref(e)[r]}t.isRef(e)?e.value=a:e=a}}function f(e,r){if(s.isObject(e)||Array.isArray(e))return s.isValidKey(r)?t.isRef(e)?r in e.value?e.value[r]:void 0:e[r]:t.isRef(e)?e.value:e}function l(e,t){return!(!s.isObject(e)&&!Array.isArray(e))&&(!!s.isValidKey(t)&&(!!(p(e)&&e.value&&t in e.value)||(!(!e||!(t in e))||void 0)))}function y(e,r){const a=t.unref(e),o=t.isRef(e);return Array.isArray(a)?(o?e.value.splice(+r,1):e.splice(+r,1),!0):!!s.isObject(a)&&(o?e.value=function(e,t=[]){return Object.keys(e).reduce((s,r)=>(t.includes(r)||(s[r]=e[r]),s),{})}(e.value,[r]):delete e[r],!0)}function m(e=[]){return"_state"!==e[0]?["_state",...e]:e}const h=s.makeSet({setProp:d,getProp:f,hasProp:l,afterGetSteps:m}),g=s.makeHas({getProp:f,hasProp:l,afterGetSteps:m}),v=(e,t)=>s.makeGet({getProp:f,hasProp:l,afterGetSteps:m}),S=(e,t)=>s.makeRemove({getProp:f,hasProp:l,removeProp:y,afterGetSteps:m}),j=s.makeSet({setProp:d,getProp:f,hasProp:l}),k=s.makeHas({getProp:f,hasProp:l}),b=s.makeGet({getProp:f,hasProp:l}),O=s.makeRemove({get:b,getProp:f,hasProp:l});var P=Object.freeze({__proto__:null,teddySet:h,teddyHas:g,teddyGet:v,teddyRemove:S,set:j,has:k,get:b,remove:O});r.use(a);const w=Symbol(),A=Symbol(),_={__options:{devtools:!0},spaces:{}},T="$",G="@",R=e=>{let t,r;if(s.isObject(e))t="space"in e?e.space:T,r="name"in e?e.name:G;else if("string"==typeof e)if(e.includes(".")){let[s,a]=e.split(".");t=s,r=a}else if(e.includes("/")){let[s,a]=e.split("/");t=s,r=a}else t=T,r=e;return"string"==typeof t&&(t=t.trim(),0===t.length&&(t=void 0)),"string"==typeof r&&(r=r.trim(),0===r.length&&(r=void 0)),{space:t,name:r}},V=(e,t)=>{const s=R(e);t=t||{};const r=te(s);return x(s,t.state),C(s,t.getters),J(s,t.actions),N(s,t.watchers),r},W=(e,s)=>t.isRef(s)?s:t.ref(s),$=(e,t,s={})=>(s._state=W(0,t),"state"in s||Object.defineProperty(s,"state",{get:()=>s._state.value,set:e=>{s._state.value=e},enumerable:!0}),s),x=(e,t)=>{const s=te(e);$(0,t,s)},z=(e,t)=>{const s=te(e);return t=t||{},Object.keys(t).reduce((e,r)=>(p(t[r])?e[r]=t[r]:"function"==typeof t[r]&&(e[r]=ne(()=>t[r](s))),e),{})},C=(e,t)=>{const s=te(e);return s.getters={...s.getters||{},...z(e,t)},s},H=(e,t)=>{const s=te(e);return t=t||{},Object.keys(t).reduce((e,r)=>("function"==typeof t[r]&&(e[r]=(...e)=>t[r](s,...e)),e),{})},J=(e,t)=>{const s=te(e);return s.actions={...s.actions||{},...H(e,t)},s},K=(e,s)=>{const{space:r,name:a}=R(e),o=te(e),n=[];return Array.isArray(s)?n.push(...s):s&&n.push(s),0===n.length?[]:n.reduce((e,s)=>{const r=(s,r,a,o)=>{const n=t.watch(r,a,{deep:!0,...o});e.push({path:s,handler:a,options:o,unwatch:n})};if("function"==typeof s)r("state",()=>o.state,s,{deep:!0});else if(s&&"object"==typeof s&&"handler"in s){const{handler:e,path:t,paths:n=[],...c}=s,i=e=>function(t,s){(void 0!==t&&void 0!==s||t!==s)&&e.call(this,t,s)};"string"==typeof t?r(t,()=>v()(o,t),i(e),{deep:!0,...c}):n.length>0?r(n.map(e=>[a,e].filter(Boolean).filter(e=>e.length>0).join(".")),n.map(e=>()=>v()(o,e)),i(e),{deep:!0,...c}):r("state",()=>o.state,i(e),{deep:!0,...c})}return e},[])},N=(e,t)=>{const s=te(e);return s.watchers=[...s.watchers||[],...K(e,t)],s},D=e=>{const{space:t,name:s}=R(e);return void 0!==s?t in _.spaces&&"stores"in _.spaces[t]&&s in _.spaces[t].stores:t in _.spaces},F=e=>{},I=(e,t,...s)=>{const{store:r}=se(e);if(t in r.actions)try{return r.actions[t](...s)}catch(e){console.error(`Something went wrong with the action '${t}'`),console.error(e)}else console.warn(`Couldn't find the action '${t}' to run.`)},M=(e,t,s)=>{const{space:r,name:a}=R(e),o=te({space:r,name:a});return S()(o,t,s)},B=(e,t,s)=>{const r=te(e);return g(r,t,s)},E=(e,t,s,r)=>{const{space:a,name:o}=R(e),n=te({space:a,name:o});return v()(n,t,s)||r},L=(e,t,s,r)=>function(){return E(e,t,s||this,r)},q=(e,t,s,r)=>{const a=te(e);h(a,t,s,r)},Q=(e,t,s)=>function(r){q(e,t,r,s||this)},U=(e,t,r)=>{const a=(t,s)=>({get:L(e,t,s),set:Q(e,t,s)});return Array.isArray(t)?t.reduce((e,t)=>(e[t]=a(t,r),e),{}):s.isObject(t)?Object.keys(t).reduce((e,s)=>(e[s]=a(t[s],r),e),{}):a(t,r)},X=(e={})=>{"function"==typeof e.teddy&&e.teddy(_);for(const t of Object.keys(_.spaces||{})){"function"==typeof e.space&&e.space(t);for(const s of Object.keys(_.spaces[t].stores||{}))"function"==typeof e.store&&e.store(t,s)}},Y=(e=(e=>e))=>({setStore:e(V),makeState:e(W),setState:e(x),applyState:e($),makeGetters:e(z),setGetters:e(C),makeActions:e(H),setActions:e(J),makeWatchers:e(K),setWatchers:e(N),exists:e(D),reset:e(F),run:e(I),remove:e(M),has:e(B),get:e(E),getter:e(L),set:e(q),setter:e(Q),sync:e(U)}),Z=(e=T)=>(e in _.spaces||(_.spaces[e]={}),_.spaces[e]),ee=(e=T)=>({store:Z(e),...Y(t=>(...s)=>t({space:e,name:G},...s))}),te=e=>{const{space:t=T,name:s=G}=R(e);return Z(t),"stores"in _.spaces[t]||(_.spaces[t].stores={}),s in _.spaces[t].stores||(_.spaces[t].stores[s]={getters:{},actions:{},watchers:[],options:{},features:{}},$(0,{},_.spaces[t].stores[s])),_.spaces[t].stores[s]},se=e=>({store:te(e),...Y(t=>(...s)=>t(e,...s))}),re=e=>{t.provide(A,se(e))},ae=()=>{t.inject(w)},oe=()=>{t.inject(A)},ne=e=>{if(s.isObject(e)){const s="get"in e&&"function"==typeof e.get,r="set"in e&&"function"==typeof e.set;return s||r?t.computed(e):Object.keys(e).reduce((s,r)=>(s[r]=t.computed(e[r]),s),{})}return t.computed(e)};var ce=Object.freeze({__proto__:null,accessors:P,features:u,Teddy:w,TeddyStore:A,Teddies:_,setStore:V,makeState:W,applyState:$,setState:x,makeGetters:z,setGetters:C,makeActions:H,setActions:J,makeWatchers:K,setWatchers:N,exists:D,reset:F,run:I,remove:M,has:B,get:E,getter:L,set:q,setter:Q,sync:U,setFeature:X,mapMethods:Y,getTeddy:Z,useTeddy:ee,getStore:te,useStore:se,provideTeddyStore:re,injectTeddy:ae,injectTeddyStore:oe,computed:ne});return e.Teddies=_,e.Teddy=w,e.TeddyStore=A,e.accessors=P,e.applyState=$,e.computed=ne,e.exists=D,e.features=u,e.get=E,e.getStore=te,e.getTeddy=Z,e.getter=L,e.has=B,e.injectTeddy=ae,e.injectTeddyStore=oe,e.install=e=>{e.prototype.$teddy=ce},e.makeActions=H,e.makeGetters=z,e.makeState=W,e.makeWatchers=K,e.mapMethods=Y,e.provideTeddyStore=re,e.remove=M,e.reset=F,e.run=I,e.set=q,e.setActions=J,e.setFeature=X,e.setGetters=C,e.setState=x,e.setStore=V,e.setWatchers=N,e.setter=Q,e.sync=U,e.useStore=se,e.useTeddy=ee,e}({},vueCompositionApi,objectStringPath,Vue);
