/*!
  * vue-teddy-store v0.2.63
  * (c) 2020 Gabin Desserprit
  * @license MIT
  */
/*!
  * vue-teddy-store v0.2.63
  * (c) 2020 Gabin Desserprit
  * @license MIT
  */
var VueTeddyStore=function(e,t,s,r,a){"use strict";var o="default"in t?t.default:t;r=r&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r,a=a&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a;const n=(e,t)=>`teddy:${e}:${t}`;var c={store(e,t){const s=se({space:e,name:t});if(s.features.cache)return;const r=window.localStorage||global.localStorage||{};if(r){const a=r.getItem(n(e,t));a&&(s.state=JSON.parse(a)),D({space:e,name:t},{handler(s){r.setItem(n(e,t),JSON.stringify(s))},immediate:!0,deep:!0}),s.features.cache=!0}}},i={store(e,s){const r=se({space:e,name:s});r.features.history||(r.features.history={},r.features.history.stack=t.reactive([]),D({space:e,name:s},{handler(e){r.features.history.stack.push({state:e,ts:(new Date).getTime()})},immediate:!0,deep:!0}),r.features.history.installed=!0)}},u={store(e,t){const s=se({space:e,name:t});s.features.sync||(s.features.sync={},window&&window.addEventListener("storage",r=>{r.key===n(e,t)&&(s.state={...s.state,...JSON.parse(r.newValue)})}),s.features.sync.installed=!0)}},p=Object.freeze({__proto__:null,cache:c,history:i,sync:u});function d(e){if(!s.isObject(e)||s.isObject(e)&&!("value"in e))return!1;return"function"==typeof Object.getOwnPropertyDescriptor(e,"value").get}function f(e,r,a){if(s.isObject(e)||Array.isArray(e)){if(s.isValidKey(r))return t.isRef(e)?t.set(e.value,r,a):t.set(e,r,a),t.unref(e)[r];t.isRef(e)?e.value=a:e=a}}function l(e,r){if(s.isObject(e)||Array.isArray(e))return s.isValidKey(r)?t.isRef(e)?r in e.value?e.value[r]:void 0:e[r]:t.isRef(e)?e.value:e}function y(e,t){return!(!s.isObject(e)&&!Array.isArray(e))&&(!!s.isValidKey(t)&&(!!(d(e)&&e.value&&t in e.value)||(!(!e||!(t in e))||void 0)))}function h(e,r){const a=t.unref(e),o=t.isRef(e);return Array.isArray(a)?(o?e.value.splice(+r,1):e.splice(+r,1),!0):!!s.isObject(a)&&(o?e.value=function(e,t=[]){return Object.keys(e).reduce((s,r)=>(t.includes(r)||(s[r]=e[r]),s),{})}(e.value,[r]):delete e[r],!0)}function m(e=[]){return"_state"!==e[0]?["_state",...e]:e}const g=s.makeSet({setProp:f,getProp:l,hasProp:y,afterGetSteps:m}),v=s.makeHas({getProp:l,hasProp:y,afterGetSteps:m}),S=()=>s.makeGet({getProp:l,hasProp:y,afterGetSteps:m}),j=()=>s.makeRemove({getProp:l,hasProp:y,removeProp:h,afterGetSteps:m}),k=s.makeSet({setProp:f,getProp:l,hasProp:y}),b=s.makeHas({getProp:l,hasProp:y}),O=s.makeGet({getProp:l,hasProp:y}),P=s.makeRemove({get:O,getProp:l,hasProp:y});var w=Object.freeze({__proto__:null,teddySet:g,teddyHas:v,teddyGet:S,teddyRemove:j,set:k,has:b,get:O,remove:P});r.use(o);const A=Symbol(),_=Symbol(),T={__options:{devtools:!0},spaces:{}},G="$",R="@",$=e=>{let t,r;if(s.isObject(e))t="space"in e?e.space:G,r="name"in e?e.name:R;else if("string"==typeof e)if(e.includes(".")){let[s,a]=e.split(".");t=s,r=a}else if(e.includes("/")){let[s,a]=e.split("/");t=s,r=a}else t=G,r=e;return"string"==typeof t&&(t=t.trim(),0===t.length&&(t=void 0)),"string"==typeof r&&(r=r.trim(),0===r.length&&(r=void 0)),{space:t,name:r}},V=(e,t)=>{const s=$(e);t=t||{};const r=se(s);return z(s,t.state),J(s,t.getters),N(s,t.actions),D(s,t.watchers),r},W=(e,s)=>t.isRef(s)?s:t.ref(s),x=(e,t,s={})=>(s._state=W(0,t),"state"in s||Object.defineProperty(s,"state",{get:()=>s._state.value,set:e=>{s._state.value=e},enumerable:!0}),s),z=(e,t)=>{const s=se(e);x(0,t,s)},H=(e,t)=>{const s=se(e);return t=t||{},Object.keys(t).reduce((e,r)=>(d(t[r])?e[r]=t[r]:"function"==typeof t[r]&&(e[r]=ce(()=>t[r](s))),e),{})},J=(e,t)=>{const s=se(e);return s.getters={...s.getters||{},...H(e,t)},s},K=(e,t)=>{const s=se(e);return t=t||{},Object.keys(t).reduce((e,r)=>("function"==typeof t[r]&&(e[r]=(...e)=>t[r](s,...e)),e),{})},N=(e,t)=>{const s=se(e);return s.actions={...s.actions||{},...K(e,t)},s},C=(e,s)=>{const{space:r,name:o}=$(e),n=se(e),c=[];return Array.isArray(s)?c.push(...s):s&&c.push(s),0===c.length?[]:c.reduce((e,s)=>{const r=e=>function(t,s){e.call(this,t,s,a(t,s))},c=(e="",t)=>`${e}||${t.toString()}`,i=(s,a,o,n)=>{e.push({path:s,signature:c(s,o),options:n,start(){return this.unwatch=t.watch(a,r(o),{deep:!0,...n}),this}})};if("function"==typeof s)i("state",()=>n.state,s,{deep:!0});else if(s&&"object"==typeof s&&"handler"in s){const{handler:e,path:t,paths:r=[],...a}=s;"string"==typeof t?i(t,()=>S()(n,t),e,{deep:!0,...a}):r.length>0?i(r.map(e=>[o,e].filter(Boolean).filter(e=>e.length>0).join(".")),r.map(e=>()=>S()(n,e)),e,{deep:!0,...a}):i("state",()=>n.state,e,{deep:!0,...a})}return e},[])},D=(e,t)=>{const s=se(e);for(const r of C(e,t)){const e=s.watchers.find(e=>{const t=e.path===r.path,s=e.signature===r.signature;return t&&s});e&&e.unwatch(),s.watchers.push(r.start())}return s},F=e=>{const{space:t,name:s}=$(e);return void 0!==s?t in T.spaces&&"stores"in T.spaces[t]&&s in T.spaces[t].stores:t in T.spaces},I=e=>{},M=(e,t,...s)=>{const{store:r}=re(e);if(t in r.actions)try{return r.actions[t](...s)}catch(e){console.error(`Something went wrong with the action '${t}'`),console.error(e)}else console.warn(`Couldn't find the action '${t}' to run.`)},q=(e,t,s)=>{r.config.devtools&&console.log("remove()",{definition:e,path:t,context:s});const{space:a,name:o}=$(e),n=se({space:a,name:o});return j()(n,t,s)},B=(e,t,s)=>{const r=se(e);return v(r,t,s)},E=(e,t,s,r)=>{const{space:a,name:o}=$(e),n=se({space:a,name:o});return S()(n,t,s)||r},L=(e,t,s,r)=>function(){return E(e,t,s||this,r)},Q=(e,t,s,a)=>{r.config.devtools&&console.log("set()",{definition:e,path:t,value:s,context:a});const o=se(e);g(o,t,s,a)},U=(e,t,s)=>function(r){Q(e,t,r,s||this)},X=(e,t,r)=>{const a=(t,s)=>({get:L(e,t,s),set:U(e,t,s)});return Array.isArray(t)?t.reduce((e,t)=>(e[t]=a(t,r),e),{}):s.isObject(t)?Object.keys(t).reduce((e,s)=>(e[s]=a(t[s],r),e),{}):a(t,r)},Y=(e={})=>{"function"==typeof e.teddy&&e.teddy(T);for(const t of Object.keys(T.spaces||{})){"function"==typeof e.space&&e.space(t);for(const s of Object.keys(T.spaces[t].stores||{}))"function"==typeof e.store&&e.store(t,s)}},Z=(e=(e=>e))=>({setStore:e(V),makeState:e(W),setState:e(z),applyState:e(x),makeGetters:e(H),setGetters:e(J),makeActions:e(K),setActions:e(N),makeWatchers:e(C),setWatchers:e(D),exists:e(F),reset:e(I),run:e(M),remove:e(q),has:e(B),get:e(E),getter:e(L),set:e(Q),setter:e(U),sync:e(X)}),ee=(e=G)=>(e in T.spaces||(T.spaces[e]={}),T.spaces[e]),te=(e=G)=>({store:ee(e),...Z(t=>(...s)=>t({space:e,name:R},...s))}),se=e=>{const{space:t=G,name:s=R}=$(e);return ee(t),"stores"in T.spaces[t]||(T.spaces[t].stores={}),s in T.spaces[t].stores||(T.spaces[t].stores[s]={getters:{},actions:{},watchers:[],options:{},features:{}},x(0,{},T.spaces[t].stores[s])),T.spaces[t].stores[s]},re=e=>({store:se(e),...Z(t=>(...s)=>t(e,...s))}),ae=e=>{t.provide(_,re(e))},oe=()=>{t.inject(A)},ne=()=>{t.inject(_)},ce=e=>{if(s.isObject(e)){const s="get"in e&&"function"==typeof e.get,r="set"in e&&"function"==typeof e.set;return s||r?t.computed(e):Object.keys(e).reduce((s,r)=>(s[r]=t.computed(e[r]),s),{})}return t.computed(e)};var ie=Object.freeze({__proto__:null,accessors:w,features:p,Teddy:A,TeddyStore:_,Teddies:T,setStore:V,makeState:W,applyState:x,setState:z,makeGetters:H,setGetters:J,makeActions:K,setActions:N,makeWatchers:C,setWatchers:D,exists:F,reset:I,run:M,remove:q,has:B,get:E,getter:L,set:Q,setter:U,sync:X,setFeature:Y,mapMethods:Z,getTeddy:ee,useTeddy:te,getStore:se,useStore:re,provideTeddyStore:ae,injectTeddy:oe,injectTeddyStore:ne,computed:ce});return e.Teddies=T,e.Teddy=A,e.TeddyStore=_,e.accessors=w,e.applyState=x,e.computed=ce,e.exists=F,e.features=p,e.get=E,e.getStore=se,e.getTeddy=ee,e.getter=L,e.has=B,e.injectTeddy=oe,e.injectTeddyStore=ne,e.install=e=>{e.prototype.$teddy=ie},e.makeActions=K,e.makeGetters=H,e.makeState=W,e.makeWatchers=C,e.mapMethods=Z,e.provideTeddyStore=ae,e.remove=q,e.reset=I,e.run=M,e.set=Q,e.setActions=N,e.setFeature=Y,e.setGetters=J,e.setState=z,e.setStore=V,e.setWatchers=D,e.setter=U,e.sync=X,e.useStore=re,e.useTeddy=te,e}({},vueCompositionApi,objectStringPath,Vue,equal);
