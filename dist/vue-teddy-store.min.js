/*!
  * vue-teddy-store v0.1.29
  * (c) 2020 Gabin Desserprit
  * @license MIT
  */
/*!
  * vue-teddy-store v0.1.29
  * (c) 2020 Gabin Desserprit
  * @license MIT
  */
var VueTeddyStore=function(t,e){"use strict";const s=t=>"teddy:store:"+t;var r={handle({name:e,store:r}){const a=window.localStorage||global.localStorage||{};if(a){const i=a.getItem(s(e));i&&(r.state={...r.state,...JSON.parse(i)}),t.watch(r.state,(t,r)=>{t!==r&&a.setItem(s(e),JSON.stringify(t))},{immediate:!0,deep:!0})}}},a={handle({store:e}){e._history=t.reactive([]),t.watch(e.state,t=>{e._history.push(t)},{immediate:!0,deep:!0})}},i={handle({name:e,store:r}){window&&window.addEventListener("storage",a=>{a.key===s(e)&&(r.state=t.reactive({...r.state,...JSON.parse(a.newValue)}))})}},n=Object.freeze({__proto__:null,cache:r,history:a,sync:i});function c(t){if(!e.isObject(t)||e.isObject(t)&&!("value"in t))return!1;return"function"==typeof Object.getOwnPropertyDescriptor(t,"value").get}function o(t){return t.filter(Boolean).filter(t=>t.length>0).join(".")}function l(t,s){return e.isValidKey(s)?c(t)?s in t.value?t.value[s]:t.value:e.isObject(t)||Array.isArray(t)?t[s]:void 0:t&&void 0===s?c(t)?t.value:t:void 0}function u(t,s){return!(!e.isObject(t)&&!Array.isArray(t))&&(!!e.isValidKey(s)&&(!!(c(t)&&t.value&&s in t.value)||(!(!t||!(s in t))||void 0)))}const h=e.makeSet({setProp:function(t,s,r){return e.isValidKey(s)&&(e.isObject(t)||Array.isArray(t))?c(t)&&"value"in t&&s in t.value?(t.value[s]=r,t.value[s]):(t[s]=r,t[s]):t&&null==s?(c(t)&&"value"in t?t.value=r:e.isObject(r)?Object.assign(t,r):t=r,t):void console.log("Couldn't not set "+s)},getProp:l,hasProp:u}),d=e.makeHas({getProp:l,hasProp:u}),y=e.makeGet({getProp:l,hasProp:u});function f(...t){return t.filter(Boolean).reduce((t,s)=>s instanceof p?s:e.isObject(s)&&s.$teddy instanceof p?s.$teddy:t,null)}class p{constructor(){this._vueInstance=null,this._stores={},this._plugins=n}add(e,s){const r=function(t,e=[]){return Object.keys(t).reduce((s,r)=>(e.includes(r)||(s[r]=t[r]),s),{})}(s,["state","getters","actions","watchers"]);this._stores[e]={state:p.createState(s.state),...p.createGetters(s.getters),...s.actions||{},...r},this[e]=this._stores[e];const a=[];Array.isArray(s.watchers)?a.push(...s.watchers):s.watcher&&a.push(s.watcher);for(let s of a)if("function"==typeof s)t.watch(()=>this._stores[e].state.value,s,{deep:!0});else if(s&&"object"==typeof s&&"handler"in s){const{handler:r,path:a,paths:i=[],...n}=s;a?t.watch(()=>y(this._stores[e].state.value,a),r,{deep:!0,...n}):i.length>0?t.watch(i.map(t=>()=>y(this._stores[e].state.value,t)),r,{deep:!0,...n}):t.watch(()=>this._stores[e].state.value,r,{deep:!0,...n})}return this}remove(t){t in this&&delete this[t],t in this._stores&&delete this._stores[t]}use(t={}){return"function"==typeof t.install&&t.install(this),"function"==typeof t.handle&&Object.keys(this._stores).map(e=>t.handle.call(this,{name:e,store:this._stores[e]})),this}activate(t=[]){Array.isArray(t)||(t=[t]);for(let e of t)e in this._plugins&&this.use(this._plugins[e]);return this}attachTo(t){return this._vueInstance=t,this}install(t){const e=this;Object.defineProperty(t.prototype,"$teddy",{get(){return e.attachTo(this)},configurable:!0})}get stores(){return this._stores}static createState(e={}){return t.isRef(e)?e:t.ref(e)}static createGetters(e){return e=e||{},Object.keys(e).reduce((s,r)=>(c(e[r])?s[r]=e[r]:"function"==typeof e[r]&&(s[r]=t.computed(e[r])),s),{})}has(t,e,s){return p.has.call(this,t,e,s)}static has(t,e,s){return s=s||this._vueInstance,d(f(this,s),o([`_stores.${t}.state`,e]),s)}get(t,e,s){return p.get.call(this,t,e,s)}static get(t,e,s){return s=s||this._vueInstance,y(f(this,s),o([`_stores.${t}.state`,e]),s)}getter(t,e,s){return p.getter.call(this,t,e,s)}static getter(t,e,s){const r=this;return function(){return p.get.call(f(this,r,s),t,e,s||this)}}set(t,e,s,r){return p.set.call(this,t,e,s,r)}static set(t,e,s,r){r=r||this._vueInstance,h(f(this,r),o([`_stores.${t}.state`,e]),s,r)}setter(t,e,s){return p.setter.call(this,t,e,s)}static setter(t,e,s){const r=this;return function(a){return p.set.call(f(this,r,s),t,e,a,s||this)}}_sync(t,e){return p._sync.call(this,t,e)}static _sync(t,e,s){return{get:p.getter.call(this,t,e,s),set:p.setter.call(this,t,e,s)}}sync(t,e,s){return p.sync.call(this,t,e,s)}static sync(t,s,r){const a=this;return Array.isArray(s)?s.reduce((e,s)=>(e[s]=p._sync.call(a,t,s,r),e),{}):e.isObject(s)?Object.keys(s).reduce((e,i)=>(e[i]=p._sync.call(a,t,s[i],r),e),{}):p._sync.call(a,t,s,r)}}return p}(vueCompositionApi,objectStringPath);
